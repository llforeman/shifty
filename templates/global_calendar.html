{% extends "base.html" %}

{% block title %}Calendario Global - Shifty{% endblock %}

{% block extra_styles %}
<style>
    .calendar-controls {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        background: white;
        padding: 15px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    /* ACTIVITY VERTICAL VIEW */
    .activity-view-table {
        width: 100%;
        border-collapse: collapse;
        background: white;
    }

    .activity-view-table th,
    .activity-view-table td {
        border: 1px solid #ddd;
        padding: 8px;
        vertical-align: top;
    }

    .activity-view-table th {
        background: #f8f9fa;
        text-align: center;
    }

    .activity-row-header {
        background: #f1f3f5;
        font-weight: bold;
        width: 150px;
    }

    .activity-cell {
        min-height: 50px;
    }

    .staff-item {
        display: block;
        padding: 2px 6px;
        margin-bottom: 2px;
        background: #e3f2fd;
        border-left: 3px solid #2196f3;
        border-radius: 2px;
        font-size: 0.85em;
    }

    .staff-time {
        font-size: 0.75em;
        color: #666;
        margin-left: 5px;
    }
</style>
{% endblock %}

{% block content %}
<div class="calendar-controls">
    <div>
        <a href="{{ url_for('global_calendar', week_offset=week_offset-1) }}" class="btn btn-sm btn-secondary">&lt;
            Anterior</a>
        <span style="font-size: 1.2em; font-weight: bold; margin: 0 15px;">
            Semana {{ start_date.strftime('%d/%m') }} - {{ end_date.strftime('%d/%m/%Y') }}
        </span>
        <a href="{{ url_for('global_calendar', week_offset=week_offset+1) }}" class="btn btn-sm btn-secondary">Siguiente
            &gt;</a>
    </div>
</div>

<!-- VIEW: ACTIVITY VERTICAL -->
<div id="activity-view" class="view-container">
    <table class="activity-view-table">
        <thead>
            <tr>
                <th style="width: 150px;">Actividad</th>
                {% for day in days %}
                <th>{{ day_names[loop.index0] }}<br><small>{{ day.strftime('%d/%m') }}</small></th>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for activity_type, activity_data in events_by_activity.items() %}
            <tr>
                <td class="activity-row-header">{{ activity_type }}</td>
                {% for day in days %}
                {% set date_str = day.strftime('%Y-%m-%d') %}
                <td class="activity-cell">
                    {% if activity_data[date_str] %}
                    {% for event in activity_data[date_str] %}
                    <div class="staff-item">
                        {{ event.pediatrician }}
                        <span class="staff-time">({{ event.time_str }})</span>
                    </div>
                    <div style="height: 2px; width: 100%; background: #2196f3; margin-bottom: 5px; opacity: 0.5;"></div>
                    {% endfor %}
                    {% endif %}
                </td>
                {% endfor %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}